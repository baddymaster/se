//
// HMAC_test.cc
// BlindStorage Test
//
// Test Vector http://tools.ietf.org/html/rfc4231

#include "gtest/gtest.h"
#include "./../src/HashMAC.h"
#include "./../src/parameters.h"
#include "./../src/Debug.h"

TEST(HMACTest, TestVector1) {
	byte key[] = {0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b};            
	string data = "Hi There";
	byte mac_expected[] = {0xb0, 0x34, 0x4c, 0x61, 0xd8, 0xdb, 0x38, 0x53, 0x5c, 0xa8, 0xaf, 0xce, 0xaf, 0x0b, 0xf1, 0x2b, 0x88, 0x1d, 0xc2, 0x00, 0xc9, 0x83, 0x3d, 0xa7, 0x26, 0xe9, 0x37, 0x6c, 0x2e, 0x32, 0xcf, 0xf7};

	byte mac_actual[SHA_BLOCK_SIZE];

	HashMAC hmac;
	hmac.setKey(key);
	hmac.doFinal(data, mac_actual);

	EXPECT_TRUE( 0 == std::memcmp(mac_expected, mac_actual, SHA_BLOCK_SIZE));
}
