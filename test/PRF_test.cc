//
// PRF_test.cc
// BlindStorage Test
//

#include "gtest/gtest.h"

#include "./../src/PRF.h"

TEST(PRFEncryption, Test1) {
		unsigned char key[] = {0x07, 0x00, 0xd6, 0x03, 0xa1, 0xc5, 0x14, 0xe4, 0x6b, 0x61, 0x91, 0xba, 0x43, 0x0a, 0x3a, 0x0c};

	byte plaintext[] = {0x06, 0x8b, 0x25, 0xc7, 0xbf, 0xb1, 0xf8, 0xbd, 0xd4, 0xcf, 0xc9, 0x08, 0xf6, 0x9d, 0xff, 0xc5, 0xdd, 0xc7, 0x26, 0xa1, 0x97, 0xf0, 0xe5, 0xf7, 0x20, 0xf7, 0x30, 0x39, 0x32, 0x79, 0xbe, 0x91};
	PRF prf;
	prf.setKey(key);
	uint32_t result_expected = 1074372545;
	uint32_t result_actual = prf.encrypt(plaintext, 0xFFFFFFFF);
	EXPECT_EQ(result_expected, result_actual);
}
